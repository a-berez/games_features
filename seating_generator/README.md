# Генератор рассадки команд

Скрипт для оптимальной рассадки команд в помещении с учетом различных критериев.

## Описание

Этот инструмент помогает организовать рассадку команд для интеллектуальных игр в одном помещении, 
учитывая различные критерии, чтобы команды с похожими параметрами (например, город, регион, место в листе ожидания и т. п.) не сидели рядом.

Основные возможности:
- Загрузка списка команд с различными параметрами из Excel-файла
- Загрузка схемы рассадки с указанием доступных и недоступных мест
- Настройка приоритета критериев для оптимальной рассадки
- Генерация нескольких вариантов рассадки с минимальными "штрафами"
- Сохранение результатов в Excel-файлы
- Возможность рассаживать команды по номеру (если он, например, присвоен на основании листа ожидания)

## Требования

- Python 3.6 или выше
- Библиотеки:
  - pandas
  - numpy

Установка зависимостей:  
```
pip install pandas numpy
```

## Использование

### Базовое использование
```
python seating_generator.py -i путь_к_файлу_команд.xlsx -s путь_к_схеме_рассадки.xlsx
```
Если запустить скрипт без параметров, он запросит пути к файлам интерактивно:
```
python seating_generator.py
```
### Параметры командной строки

- `-i`, `--input`: Путь к Excel-файлу со списком команд
- `-s`, `--seating`: Путь к Excel-файлу со схемой рассадки
- `-abc`, `--alphabetical_order`: Игнорировать номера при рассадке
- `-o`, `--order`: Порядок важности столбцов (например, "2,4,1,3")

### Формат входных данных

#### Файл со списком команд (Excel)

Должен содержать следующие столбцы:
- `team` (обязательный): Название команды
- Другие столбцы (не более 5): Критерии для рассадки (город, регион, номер и т.д.). Столбец с номером всегда должен называться `number`

Порядок столбцов слева направо соответствует важности критерия при рассадке.  
Чтобы отключить учёт номеров команд при наличии столбца `number`, используйте флаг `-abc`/`--alphabetical_order`  

#### Файл со схемой рассадки (Excel)

Содержит схему помещения, где:
- `X`: доступное место для размещения команды
- `O`: недоступное место

Пример:
```
XXXX
XXOX
XXXX
XXXX
```
### Выходные данные

Скрипт генерирует следующие файлы:

- `seating.xlsx`: Лучший вариант рассадки
- `seating_1.xlsx`, `seating_2.xlsx`: Альтернативные варианты рассадки (если доступны)

В выходных файлах места, где размещены команды, содержат их названия, а недоступные места 
помечены как "НЕДОСТУПНО".

## Примеры

В папке `examples` находятся примеры входных файлов:

- `teams.xlsx`: Пример файла со списком команд
- `places.xlsx`: Пример файла со схемой рассадки

### Пример запуска
```
python seating_generator.py -i examples/teams.xlsx -s examples/places.xlsx
```
## Алгоритм работы

1. Загрузка данных о командах и схеме рассадки
2. Определение порядка важности критериев
3. Генерация нескольких начальных вариантов рассадки
4. Оптимизация каждого варианта путем перестановки команд
5. Выбор лучших вариантов и сохранение результатов

